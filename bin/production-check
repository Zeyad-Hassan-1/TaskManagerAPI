#!/bin/bash
# Production Email Configuration Test

echo "üìß Production Email Configuration Test"
echo "====================================="

# Source the production environment
if [ -f .env.production ]; then
    source .env.production
    echo "‚úÖ Loaded production environment variables"
else
    echo "‚ùå .env.production file not found"
    exit 1
fi

# Check required SMTP variables
echo ""
echo "üìã Configuration Check:"
echo "‚úÖ SMTP Server: ${SMTP_ADDRESS}:${SMTP_PORT}"
echo "‚úÖ SMTP Username: ${SMTP_USERNAME}"
echo "‚úÖ SMTP Domain: ${SMTP_DOMAIN}"

if [ -n "$SMTP_PASSWORD" ]; then
    echo "‚úÖ SMTP Password: [CONFIGURED]"
else
    echo "‚ùå SMTP Password: [NOT SET]"
    exit 1
fi

echo "‚úÖ Authentication: ${SMTP_AUTHENTICATION}"
echo "‚úÖ STARTTLS: ${SMTP_ENABLE_STARTTLS_AUTO}"

echo ""
echo "üîß Production Setup Status:"
echo "‚úÖ Gmail SMTP configured with app password"
echo "‚úÖ Email address: ${SMTP_USERNAME}"
echo "‚úÖ Secure connection enabled"

echo ""
echo "üöÄ Ready for Production Deployment!"
echo ""
echo "Next steps:"
echo "1. Update APP_HOST in .env.production with your actual domain"
echo "2. Choose deployment platform (Heroku recommended)"
echo "3. Set environment variables on your platform"
echo "4. Deploy and test password reset functionality"

echo ""
echo "üéØ Deployment Commands for Heroku:"
echo "heroku create your-app-name"
echo "heroku addons:create heroku-postgresql:essential-0"
echo "heroku config:set \$(cat .env.production | grep '^export' | sed 's/export //' | xargs)"
echo "git push heroku main"
echo "heroku run rails db:migrate db:seed"
